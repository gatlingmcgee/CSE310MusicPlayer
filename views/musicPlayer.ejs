<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Sean Sonderegger">
    <meta name="description" content="Music Player Application utilizing JavaScript and Node. Allows users to create and manage playlists of their favorite songs.">
    <title>CSE310MusicPlayer</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Itim&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="/styles/musicPlayer.css">
</head>
<body>
<h1>Now Playing</h1>
<!-- song details -->
  <p><strong>Title:</strong> <%= title %></p>
  <p><strong>Artist:</strong> <%= artist %></p>
  <p><strong>Genre:</strong> <%= genre %></p>
  <!-- container for styling of video -->
<div class="iframeContainer">
  <iframe
  width="560"
  height="315"
  src="https://www.youtube.com/embed/<%= videoId %>"
  frameborder="0"
  allow="encrypted-media"
  allowfullscreen>
  </iframe>
</div>
<!-- navigation links -->
<div class="nowPlayingDiv">
  <br /><br />
  <a href="/" class="secondaryLink">Add Another Song</a> |
  <a href="/playlist" class="secondaryLink">Go to Playlist</a>
</div>
<!-- script to build playlist -->
<script>
  const song = {
    title: "<%= title %>",
    artist: "<%= artist %>",
    genre: "<%= genre %>",
    videoId: "<%= videoId %>"
  };
  // playlist in local storage
  const playlist = JSON.parse(localStorage.getItem("playlist")) || [];
  // validation to prevent duplicate songs
  const alreadyExists = playlist.some(s => s.videoId === song.videoId);
  if (!alreadyExists) {
    playlist.push(song);
    localStorage.setItem("playlist", JSON.stringify(playlist));
    // message to confirm addition or duplication
    alert("Song added to playlist!");
  } else {
    alert("This song is already in your playlist!");
  }
</script>
</body>
</html>